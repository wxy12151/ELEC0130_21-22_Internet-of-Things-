[{"id":"4ce6f98c.254bf","type":"tab","label":"Edge","disabled":false,"info":""},{"id":"cb28ea7b785b43b7","type":"ibmiot in","z":"4ce6f98c.254bf","authentication":"apiKey","apiKey":"a250f6a0ce2acc43","inputType":"evt","logicalInterface":"","ruleId":"","deviceId":"","applicationId":"","deviceType":"+","eventType":"+","commandType":"","format":"json","name":"IBM IoT","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":true,"allLogicalInterfaces":"","allEvents":true,"allCommands":"","allFormats":"","qos":0,"x":76.00004196166992,"y":1147.0000276565552,"wires":[["4c50197ffcfaf155","44d694e7b3c7934e","4895c39cfed08a24","d33e89196bfec1ca","0422699f1cd558d1","bc93a357c858836f","e705ecfbf6eff8e8","fffb6f11a3563490","d6c917e051e2056f"]]},{"id":"4c50197ffcfaf155","type":"change","z":"4ce6f98c.254bf","name":"Chart Light","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.d.Light","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":365.7523193359375,"y":1180.027826309204,"wires":[["1ae34dfe9c9b8716","afcb1047829dc72e"]]},{"id":"1be8b77291f3dbfa","type":"switch","z":"4ce6f98c.254bf","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":570.4445419311523,"y":1291.4444942474365,"wires":[["31d0f910b9f161be"],["025d4569006e17af"]]},{"id":"31d0f910b9f161be","type":"function","z":"4ce6f98c.254bf","name":"start","func":"var a = flow.get('counter')\nif(a==0){\nvar t1 = Date.now();\nflow.set('t1', t1);\nmsg.payload = 0;\n}else{\nvar t2 = Date.now();\nvar t1 = flow.get('t1');\nvar total_time = t2 - t1\nflow.set('total_time',total_time);\nmsg.payload = total_time;\n}\n\nflow.set('counter',a+1);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":805.5669288635254,"y":1285.4718647003174,"wires":[["eaf9fd0b2d3b0abd","17bcb79be35b4197"]]},{"id":"025d4569006e17af","type":"function","z":"4ce6f98c.254bf","name":"stop","func":"flow.set('total_time',0);\nflow.set('counter',0);\nmsg.payload=flow.get('total_time');\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":815.30784034729,"y":1355.027421951294,"wires":[["eaf9fd0b2d3b0abd"]]},{"id":"44d694e7b3c7934e","type":"function","z":"4ce6f98c.254bf","name":"count initial","func":"","outputs":1,"noerr":0,"initialize":"// Code added here will be run once\n// whenever the node is started.\nflow.set('counter',0);\nflow.set('counter2',0);\nflow.set('counter3',0)\nflow.set('lightThreshold',50);\nflow.set('DoorThreshold',50);","finalize":"","libs":[],"x":320.1111602783203,"y":895.9998741149902,"wires":[[]]},{"id":"eaf9fd0b2d3b0abd","type":"function","z":"4ce6f98c.254bf","name":"engine runtime","func":"var ms = parseInt(msg.payload);\nvar t = ms/1000;\nvar h = (Math.floor(t / 3600)).toString();\nvar m = (\"0\" + (Math.floor(t%3600 / 60))).slice(-2);\nvar s = (\"0\" + (Math.floor(t%3600 % 60))).slice(-2);\n\nvar ts = h + \":\" +  m + \":\" + s;\nmsg.payload=ts;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1120.2707405090332,"y":1350.805320262909,"wires":[["a25999cc25d3ba37"]]},{"id":"17bcb79be35b4197","type":"function","z":"4ce6f98c.254bf","name":"alert","func":"var ms=parseInt(msg.payload);\nvar thr = flow.get('lightThreshold')*1000;\nif(ms>=thr) \n { \n   msg.payload = 1;\n }\nelse{return null}\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1089.4189147949219,"y":1292.9166436195374,"wires":[["cb8ebd51a962cf47","c5dbd5673a9b6880","eb3c1577a3e39821"]]},{"id":"1962be7b9b463906","type":"function","z":"4ce6f98c.254bf","name":"reset","func":"flow.set('counter',msg.payload);\nflow.set('last',0);\nflow.set('light',0)\nflow.set('counter',0);\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1049.1596069335938,"y":1409.36083984375,"wires":[[]]},{"id":"3b88037c31958f9b","type":"trigger","z":"4ce6f98c.254bf","name":"","op1":"","op2":"0","op1type":"nul","op2type":"num","duration":"20","extend":true,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":694.412712097168,"y":1408.2695007324219,"wires":[["1962be7b9b463906"]]},{"id":"3d8562426bef1f73","type":"ui_text","z":"4ce6f98c.254bf","group":"1bb2d88d.8be177","order":5,"width":0,"height":0,"name":"","label":"Light Threshold","format":"{{msg.payload}} seconds","layout":"row-spread","className":"","x":1615,"y":1384.000244140625,"wires":[]},{"id":"f65f54778ebd5db9","type":"ui_slider","z":"4ce6f98c.254bf","name":"Light Threshold ","label":"slider","tooltip":"","group":"1bb2d88d.8be177","order":6,"width":0,"height":0,"passthru":true,"outs":"all","topic":"topic","topicType":"msg","min":"10","max":"100","step":1,"className":"","x":1359,"y":1430.000244140625,"wires":[["3d8562426bef1f73","bd70e786cc8b63c5"]]},{"id":"4895c39cfed08a24","type":"change","z":"4ce6f98c.254bf","name":"Chart Touched ","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.d.Touched","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":319.4444580078125,"y":1520.8889541625977,"wires":[["11ccfb01bedf7c3d","4066bfd922980c25"]]},{"id":"11ccfb01bedf7c3d","type":"ui_chart","z":"4ce6f98c.254bf","name":"","group":"e77a4192185faba3","order":1,"width":0,"height":0,"label":"Touched chart","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"0","ymax":"1","removeOlder":"10","removeOlderPoints":"","removeOlderUnit":"60","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":556.1110229492188,"y":1521.0001220703125,"wires":[[]]},{"id":"370ce6dbcf34db8e","type":"debug","z":"4ce6f98c.254bf","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1114.8463134765625,"y":2244.010717391968,"wires":[]},{"id":"d816ea9b43cf42a1","type":"function","z":"4ce6f98c.254bf","name":"f","func":"var t = msg.payload.time;\nflow.set('t',t);\nmsg.payload = t;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":962.6799240112305,"y":2245.01082611084,"wires":[["370ce6dbcf34db8e","5d547f7bc82bf323"]]},{"id":"0d7b1b3f432b6b83","type":"function","z":"4ce6f98c.254bf","name":"f2","func":"var now = new Date();\n\nlet localDate = new Date(now.toLocaleString('en-US', { timeZone: \"Europe/London\" }));\nlet offset = now.getTime() - localDate.getTime();\nnow.setTime( now.getTime() + offset );\n\n\nvar hh = now.getHours() < 10 ? \"0\" + now.getHours() : now.getHours();\nvar mmm  = now.getMinutes() < 10 ? \"0\" + now.getMinutes() : now.getMinutes();\nvar current=  hh+\":\"+mmm;\n\nif(current==flow.get('t')){\n    msg.payload = 2;\n}else{\n    return null;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":463.34643936157227,"y":2068.01070022583,"wires":[["7e9ae68045bfbd4e","24aa8a0394a8a92b"]]},{"id":"7e9ae68045bfbd4e","type":"debug","z":"4ce6f98c.254bf","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":653.6799926757812,"y":2035.0107421875,"wires":[]},{"id":"19f40dd16174b94f","type":"inject","z":"4ce6f98c.254bf","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"10","crontab":"","once":false,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":288.4349670410156,"y":2066.9845762252808,"wires":[["0d7b1b3f432b6b83"]]},{"id":"d33e89196bfec1ca","type":"change","z":"4ce6f98c.254bf","name":"Chart Door","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.d.Door","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":330.8464584350586,"y":1056.010383605957,"wires":[["9d1151194b3fd54e","6ce8d69895705a73","88537999220e8499"]]},{"id":"9d1151194b3fd54e","type":"ui_chart","z":"4ce6f98c.254bf","name":"","group":"165ea06f704627e9","order":1,"width":0,"height":0,"label":"Door chart (1 for closed, 0 for open)","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"step","nodata":"","dot":false,"ymin":"0","ymax":"1","removeOlder":"10","removeOlderPoints":"","removeOlderUnit":"60","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":634.8464584350586,"y":1062.010398864746,"wires":[[]]},{"id":"0422699f1cd558d1","type":"switch","z":"4ce6f98c.254bf","name":"Detect Door","property":"payload.d.Door","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":318.8464164733887,"y":976.0104036331177,"wires":[["a08904124e5186f0","c122d488feeeb33c"],["43fe1be4f51f07b4","c122d488feeeb33c"]]},{"id":"a08904124e5186f0","type":"function","z":"4ce6f98c.254bf","name":"start","func":"var a = flow.get('counter2')\nif(a==0){\nvar t1 = Date.now();\nflow.set('2t1', t1);\nmsg.payload = 0;\n}else{\nvar t2 = Date.now();\nvar t1 = flow.get('2t1');\nvar total_time = t2 - t1\nflow.set('total_time2',total_time);\nmsg.payload = total_time;\n\n}\n\nflow.set('counter2',a+1);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":583.8464088439941,"y":880.0103902816772,"wires":[["779036e43e140ff9","0c4db81cab0dc25d"]]},{"id":"43fe1be4f51f07b4","type":"function","z":"4ce6f98c.254bf","name":"stop","func":"flow.set('total_time2',0);\nflow.set('counter2',0);\nmsg.payload=flow.get('total_time2');\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":584.0317802429199,"y":942.121416091919,"wires":[["779036e43e140ff9"]]},{"id":"779036e43e140ff9","type":"function","z":"4ce6f98c.254bf","name":"engine runtime","func":"var ms = parseInt(msg.payload);\nvar t = ms/1000;\nvar h = (Math.floor(t / 3600)).toString();\nvar m = (\"0\" + (Math.floor(t%3600 / 60))).slice(-2);\nvar s = (\"0\" + (Math.floor(t%3600 % 60))).slice(-2);\n\nvar ts = h + \":\" +  m + \":\" + s;\nmsg.payload = ts;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":781.772331237793,"y":879.2326602935791,"wires":[["cdeaa2f229f500be"]]},{"id":"bb06e9c74e3534ad","type":"function","z":"4ce6f98c.254bf","name":"reset","func":"flow.set('counter2',msg.payload);\nflow.set('total_time2',0);","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":791.7722587585449,"y":990.010175704956,"wires":[[]]},{"id":"c122d488feeeb33c","type":"trigger","z":"4ce6f98c.254bf","name":"","op1":"","op2":"0","op1type":"nul","op2type":"num","duration":"20","extend":true,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":595.8032150268555,"y":987.9187860488892,"wires":[["bb06e9c74e3534ad"]]},{"id":"f8d78aba0e95b183","type":"ibmiot out","z":"4ce6f98c.254bf","authentication":"apiKey","apiKey":"a250f6a0ce2acc43","outputType":"cmd","deviceId":"9C9C1FC16194","deviceType":"mkr1010","eventCommandType":"display","format":"json","data":"msg.payload","qos":0,"name":"IBM IoT","service":"registered","x":1022.846435546875,"y":823.0103759765625,"wires":[]},{"id":"0c4db81cab0dc25d","type":"function","z":"4ce6f98c.254bf","name":"alert","func":"var ms=parseInt(msg.payload);\nvar thr=flow.get('DoorThreshold')*1000;\nif(ms>=thr) \n {\n   msg.payload = 3;\n }\nelse{return null}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750.8463745117188,"y":812.0103759765625,"wires":[["d082836eb6b36464","f8d78aba0e95b183","a3cce9c4ad84c072"]]},{"id":"11f95b8558b35e08","type":"debug","z":"4ce6f98c.254bf","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":547.0000076293945,"y":71.05209636688232,"wires":[]},{"id":"186e08ae19cab409","type":"change","z":"4ce6f98c.254bf","name":"Chart Temperature","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.d.Temperature","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":570,"y":115.05209350585938,"wires":[["6416358381d2aded","969537d294cfb22f"]]},{"id":"3b57ad47c8bd4e71","type":"change","z":"4ce6f98c.254bf","name":"Chart Button","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.d.Button","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":550,"y":155.05209350585938,"wires":[[]]},{"id":"193457e0352ea8e5","type":"switch","z":"4ce6f98c.254bf","name":"Warn on High Temperature Values","property":"payload.d.Temperature","propertyType":"msg","rules":[{"t":"gt","v":"threshold","vt":"global"}],"checkall":"true","repair":false,"outputs":1,"x":620,"y":195.05209350585938,"wires":[["a21e1a95b5f74016","342b03834f55b9db"]]},{"id":"a21e1a95b5f74016","type":"template","z":"4ce6f98c.254bf","name":"Alert Msg","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Alert : Critical Value Detected {{payload.d.Temperature}}","output":"str","x":907.0000534057617,"y":195.05209350585938,"wires":[["cb7a88b2a1ef08b5"]]},{"id":"6416358381d2aded","type":"ui_chart","z":"4ce6f98c.254bf","name":"","group":"5459e4d16930a8b0","order":1,"width":0,"height":0,"label":"Temp chart","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"0","ymax":"50","removeOlder":"10","removeOlderPoints":"","removeOlderUnit":"60","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":786.0000457763672,"y":112.05209541320801,"wires":[[]]},{"id":"cb7a88b2a1ef08b5","type":"ui_toast","z":"4ce6f98c.254bf","position":"top right","displayTime":"5","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"","name":"","x":1102.9999923706055,"y":193.05209350585938,"wires":[]},{"id":"032e3c0a14ca4ff5","type":"debug","z":"4ce6f98c.254bf","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":508,"y":591.0521221160889,"wires":[]},{"id":"38d628265f294462","type":"ibmiot out","z":"4ce6f98c.254bf","authentication":"boundService","apiKey":"e45f276432ecdd8d","outputType":"cmd","deviceId":"4c11ae91134c","deviceType":"mkr1010","eventCommandType":"display","format":"json","data":"msg.payload","qos":0,"name":"IBM IoT App out","service":"registered","x":520,"y":495.0520935058594,"wires":[]},{"id":"8933b9a365b6ab0d","type":"ui_switch","z":"4ce6f98c.254bf","name":"","label":"Switch","tooltip":"","group":"0a8366eac8ed8936","order":2,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","topicType":"str","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","animate":true,"className":"","x":450,"y":395.0520935058594,"wires":[["16ad3edd5652dcea","967349fdc295aa6c"]]},{"id":"75b848b7523a44b6","type":"ui_text","z":"4ce6f98c.254bf","group":"0a8366eac8ed8936","order":1,"width":0,"height":0,"name":"","label":"","format":"{{msg.payload}}","layout":"row-spread","className":"","x":450,"y":335.0520935058594,"wires":[]},{"id":"63d0d0a73372c921","type":"inject","z":"4ce6f98c.254bf","name":"Instructions","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"","topic":"","payload":"Use the toggle switch to manually turn on/off the alert ","payloadType":"str","x":290,"y":335.0520935058594,"wires":[["75b848b7523a44b6"]]},{"id":"c6c17412d6ddc3cc","type":"link out","z":"4ce6f98c.254bf","name":"","links":["8245f232bf012f4f"],"x":962,"y":356.0520935058594,"wires":[]},{"id":"8245f232bf012f4f","type":"link in","z":"4ce6f98c.254bf","name":"","links":["c6c17412d6ddc3cc"],"x":253.00000190734863,"y":549.0521411895752,"wires":[["38d628265f294462","032e3c0a14ca4ff5"]]},{"id":"f240548f75f49b5e","type":"inject","z":"4ce6f98c.254bf","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"10","crontab":"","once":false,"onceDelay":"","topic":"","payloadType":"date","x":290,"y":395.0520935058594,"wires":[["8933b9a365b6ab0d"]]},{"id":"967349fdc295aa6c","type":"function","z":"4ce6f98c.254bf","name":"Alert 9 for remote control","func":"if( msg.payload === false ) {\n    return null;\n}\nelse{\nmsg.payload = 9;\nreturn msg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":375.0520935058594,"wires":[["c6c17412d6ddc3cc"]]},{"id":"bdfda1ec1f289ae5","type":"function","z":"4ce6f98c.254bf","name":"Alert 1 for overheat","func":"var th = global.get('threshold')\nif( msg.payload.d.Temperature < th ) {\n   return null;\n}\nelse{\nmsg.payload = 1;\nreturn msg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":630,"y":275.0520935058594,"wires":[["c6c17412d6ddc3cc"]]},{"id":"16ad3edd5652dcea","type":"switch","z":"4ce6f98c.254bf","name":"Manual alarm","property":"payload","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":620,"y":435.0520935058594,"wires":[["66d34676807faa65"]]},{"id":"66d34676807faa65","type":"template","z":"4ce6f98c.254bf","name":"Alert Msg","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Alert : Abnormal situation","output":"str","x":820,"y":435.0520935058594,"wires":[["b3883ffbbb635983"]]},{"id":"b3883ffbbb635983","type":"ui_toast","z":"4ce6f98c.254bf","position":"top right","displayTime":"5","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"","name":"","x":1030,"y":435.0520935058594,"wires":[]},{"id":"f477a7a7c1264802","type":"ui_text","z":"4ce6f98c.254bf","group":"5459e4d16930a8b0","order":3,"width":0,"height":0,"name":"","label":"Temp threshold","format":"{{msg.payload}}","layout":"row-spread","className":"","x":1403,"y":487.0520935058594,"wires":[]},{"id":"ce575488c24d9d5b","type":"change","z":"4ce6f98c.254bf","name":"","rules":[{"t":"set","p":"threshold","pt":"global","to":"payload","tot":"msg","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":1373,"y":567.0520935058594,"wires":[[]]},{"id":"75ddd2c7b3527876","type":"ui_slider","z":"4ce6f98c.254bf","name":"Temp threshold ","label":"slider","tooltip":"","group":"5459e4d16930a8b0","order":2,"width":0,"height":0,"passthru":true,"outs":"all","topic":"topic","topicType":"msg","min":"20","max":"35","step":1,"className":"","x":1143,"y":527.0520935058594,"wires":[["ce575488c24d9d5b","f477a7a7c1264802"]]},{"id":"a8115e647c1b6a1d","type":"switch","z":"4ce6f98c.254bf","name":"Warn on button","property":"payload.d.Button","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":600,"y":235.05209350585938,"wires":[["4c9017b28b97666f","0c8a610d9a5258d0"]]},{"id":"4c9017b28b97666f","type":"template","z":"4ce6f98c.254bf","name":"Alert Msg","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Alert : SOS!","output":"str","x":820,"y":235.05209350585938,"wires":[["74d76ec013abc6d0"]]},{"id":"74d76ec013abc6d0","type":"ui_toast","z":"4ce6f98c.254bf","position":"top right","displayTime":"5","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"","name":"","x":1020,"y":235.05209350585938,"wires":[]},{"id":"7dd3b3c769ca1cd6","type":"function","z":"4ce6f98c.254bf","name":"Alert 2 for button alarm","func":"if( msg.payload.d.Button == 0 ) {\n   return null;\n}\nelse{\nmsg.payload = 2;\nreturn msg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":660,"y":315.0520935058594,"wires":[["c6c17412d6ddc3cc"]]},{"id":"37ebb545b0d422ad","type":"ibmiot in","z":"4ce6f98c.254bf","authentication":"apiKey","apiKey":"e45f276432ecdd8d","inputType":"evt","logicalInterface":"","ruleId":"","deviceId":"","applicationId":"","deviceType":"","eventType":"","commandType":"","format":"","name":"IBM IoT App In","service":"registered","allDevices":true,"allApplications":"","allDeviceTypes":true,"allLogicalInterfaces":false,"allEvents":true,"allCommands":"","allFormats":"","qos":"0","x":260,"y":135.05209350585938,"wires":[["11f95b8558b35e08","186e08ae19cab409","3b57ad47c8bd4e71","193457e0352ea8e5","a8115e647c1b6a1d","bdfda1ec1f289ae5","7dd3b3c769ca1cd6"]]},{"id":"bc93a357c858836f","type":"switch","z":"4ce6f98c.254bf","name":"Someone in the room?","property":"payload.d.Motion","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":403.4572067260742,"y":1402.1827278137207,"wires":[["025d4569006e17af"]]},{"id":"1ae34dfe9c9b8716","type":"function","z":"4ce6f98c.254bf","name":"tosql","func":"var current = new Date().toLocaleString(\"en-GB\");\nvar sql= \"INSERT INTO HDB69390.Dataset (Time,Light) VALUES ('\"+current+\"','\"+msg.payload+\"');\"\nmsg.payload = sql;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":591.6067810058594,"y":1159.71875,"wires":[["9b15b6e5ce674bfb"]]},{"id":"9b15b6e5ce674bfb","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"","params":"","name":"db","x":778.0130214691162,"y":1162.0103912353516,"wires":[[]]},{"id":"48ec33712d540654","type":"ui_form","z":"4ce6f98c.254bf","name":"","label":"","group":"2e7403489e979f39","order":3,"width":0,"height":0,"options":[{"label":"Change Reporting Interval","value":"number","type":"number","required":false,"rows":null},{"label":"Change Delay","value":"delay","type":"number","required":false,"rows":null}],"formValue":{"number":"","delay":""},"payload":"","submit":"submit","cancel":"cancel","topic":"topic","topicType":"msg","splitLayout":"","className":"","x":774.0000076293945,"y":2431.666792869568,"wires":[["5e4d1df08b9518a6","094591b2b42c6337"]]},{"id":"5d547f7bc82bf323","type":"ui_text","z":"4ce6f98c.254bf","group":"e77a4192185faba3","order":4,"width":0,"height":0,"name":"","label":"Current Remind Time: ","format":"{{msg.payload}}","layout":"row-spread","className":"","x":1146.111083984375,"y":2185.3334169387817,"wires":[]},{"id":"9c778d5976e92e6b","type":"ui_form","z":"4ce6f98c.254bf","name":"","label":"Medicine Time Remind Set","group":"e77a4192185faba3","order":3,"width":0,"height":0,"options":[{"label":"","value":"time","type":"text","required":false,"rows":null}],"formValue":{"time":""},"payload":"","submit":"submit","cancel":"cancel","topic":"topic","topicType":"msg","splitLayout":"","className":"","x":748.111083984375,"y":2244.33349609375,"wires":[["d816ea9b43cf42a1"]]},{"id":"5e4d1df08b9518a6","type":"function","z":"4ce6f98c.254bf","name":"f","func":"var t = msg.payload.number;\nif(t<1){\n    msg.payload = \"Invalid interval\"    \n}else{\n    msg.payload = t;\n}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":986.111083984375,"y":2432.3334188461304,"wires":[["1ff7fd92a223d81c","9a776bfce807ca24"]]},{"id":"1ff7fd92a223d81c","type":"ui_text","z":"4ce6f98c.254bf","group":"2e7403489e979f39","order":2,"width":0,"height":0,"name":"","label":"Current Interval: ","format":"{{msg.payload}} seconds","layout":"row-spread","className":"","x":1164.111083984375,"y":2378.333417892456,"wires":[]},{"id":"9a776bfce807ca24","type":"function","z":"4ce6f98c.254bf","name":"f","func":"var a =  msg.payload;\nif(a!=\"Invalid interval\" ){\n    msg.payload = a;\n    return msg;\n}else{\n    return null;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1144.111083984375,"y":2433.666669845581,"wires":[["c442a6f8deee982e"]]},{"id":"c442a6f8deee982e","type":"ibmiot out","z":"4ce6f98c.254bf","authentication":"apiKey","apiKey":"a250f6a0ce2acc43","outputType":"cmd","deviceId":"9C9C1FC16194","deviceType":"mkr1010","eventCommandType":"interval","format":"json","data":"msg.payload","qos":0,"name":"IBM IoT","service":"registered","x":1317.4444580078125,"y":2433.6666707992554,"wires":[]},{"id":"afcb1047829dc72e","type":"ui_chart","z":"4ce6f98c.254bf","name":"","group":"1bb2d88d.8be177","order":1,"width":0,"height":0,"label":"Light chart","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"30","removeOlderPoints":"","removeOlderUnit":"60","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1973b3","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":614.7894630432129,"y":1205.0277652740479,"wires":[[]]},{"id":"d082836eb6b36464","type":"template","z":"4ce6f98c.254bf","name":"Alert Msg","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Door opened for a long time!","output":"str","x":1021.8463516235352,"y":770.0102944374084,"wires":[["8806d0fd2be6c7cc"]]},{"id":"8806d0fd2be6c7cc","type":"ui_toast","z":"4ce6f98c.254bf","position":"top right","displayTime":"5","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"","name":"","x":1232.846607208252,"y":770.0102596282959,"wires":[]},{"id":"cb8ebd51a962cf47","type":"template","z":"4ce6f98c.254bf","name":"Alert Msg","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Light was on for a long time!","output":"str","x":1346.6798667907715,"y":1294.010561466217,"wires":[["ea9f83f960108d6e"]]},{"id":"ea9f83f960108d6e","type":"ui_toast","z":"4ce6f98c.254bf","position":"top right","displayTime":"5","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"","name":"","x":1550.6799812316895,"y":1292.010561466217,"wires":[]},{"id":"edc33c15f58b7b5d","type":"template","z":"4ce6f98c.254bf","name":"Alert Msg","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"The medicine bottle has been touched {{payload}} times today!","output":"str","x":827.8463745117188,"y":1570.010498046875,"wires":[["79b0b00ce2418d4c"]]},{"id":"79b0b00ce2418d4c","type":"ui_toast","z":"4ce6f98c.254bf","position":"top right","displayTime":"5","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"","name":"","x":1092.8465576171875,"y":1570.0103759765625,"wires":[]},{"id":"e705ecfbf6eff8e8","type":"function","z":"4ce6f98c.254bf","name":"Detect Light On","func":"var current = msg.payload.d.Light;\n\nif((current-flow.get('last'))>=200&&flow.get('light')==0){\n    msg.payload=\"on\";\n    flow.set('light',1);\n}\nif ((flow.get('last')-current)>=200&&flow.get('light')==1){\n    msg.payload=\"off\";\n    flow.set('light',0)\n}\nif(flow.get('light')==1){\n        msg.payload=\"on\"\n}\nif(flow.get('light')==0)\n{\n        msg.payload=\"off\";\n    }\n    \n\nflow.set('last',current);\nreturn msg;","outputs":1,"noerr":0,"initialize":"// Code added here will be run once\n// whenever the node is started.\nflow.set('light',0)","finalize":"","libs":[],"x":370.92974853515625,"y":1289.7160816192627,"wires":[["1be8b77291f3dbfa","1438e8af81af6551","3b88037c31958f9b"]]},{"id":"1438e8af81af6551","type":"ui_text","z":"4ce6f98c.254bf","group":"1bb2d88d.8be177","order":2,"width":0,"height":0,"name":"","label":"Current Light state:","format":"{{payload}} ","layout":"row-spread","className":"","x":573.9999771118164,"y":1341.999984741211,"wires":[]},{"id":"bd70e786cc8b63c5","type":"function","z":"4ce6f98c.254bf","name":"set thresholf of light","func":"var thr = msg.payload;\nflow.set('lightThreshold',thr);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1628.3333053588867,"y":1455.000117301941,"wires":[[]]},{"id":"c5dbd5673a9b6880","type":"function","z":"4ce6f98c.254bf","name":"f","func":"var ms = msg.payload;\nvar current = new Date().toLocaleString(\"en-GB\");\nvar alert = \"Light was on for a long time!\"\nvar sql= \"INSERT INTO HDB69390.Dataset (Time,Type,Info) VALUES ('\"+current+\"','Light','\"+alert+\"');\"\nmsg.payload = sql;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1334.1112022399902,"y":1225.3332600593567,"wires":[["e76663052a2dd159"]]},{"id":"e76663052a2dd159","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"","params":"","name":"db","x":1538.1113090515137,"y":1224.8889241218567,"wires":[[]]},{"id":"875f12665c9e75b8","type":"ui_table","z":"4ce6f98c.254bf","group":"8d9c5eafccaf7b45","name":"","order":1,"width":12,"height":8,"columns":[{"field":"TYPE","title":"Type","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"INFO","title":"Info","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"TIME","title":"Time","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}}],"outputs":0,"cts":false,"x":861.7778739929199,"y":1949.888957977295,"wires":[]},{"id":"1119f67839bfb706","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"","params":"","name":"db","x":634.7778739929199,"y":1948.888916015625,"wires":[["875f12665c9e75b8"]]},{"id":"c144e6c1c164adae","type":"function","z":"4ce6f98c.254bf","name":"f","func":"\nvar sql= \"SELECT TYPE,INFO,Time FROM HDB69390.Dataset WHERE TYPE IS NOT NULL order by TIME DESC fetch first 30 rows only\";\nmsg.payload = sql;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":471.7778625488281,"y":1949.888916015625,"wires":[["1119f67839bfb706"]]},{"id":"543b2af5606aa23e","type":"inject","z":"4ce6f98c.254bf","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"5","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":295.6668701171875,"y":1947.888916015625,"wires":[["c144e6c1c164adae"]]},{"id":"b76389775e5a43ec","type":"function","z":"4ce6f98c.254bf","name":"f","func":"var a = msg.payload;\n\nvar current = new Date().toLocaleString(\"en-GB\");\nvar alert = \"The medicine has been touched \" + a +\" times today!\"\nvar sql= \"INSERT INTO HDB69390.Dataset (Time,Type,Info) VALUES ('\"+current+\"','Touch','\"+alert+\"');\"\nmsg.payload = sql;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":834,"y":1669,"wires":[["2faf5d53c95c89ff"]]},{"id":"2faf5d53c95c89ff","type":"Db2 in","z":"4ce6f98c.254bf","d":true,"Db2":"ae43218bc16e9689","service":"_ext_","query":"","params":"","name":"db","x":1000.0001220703125,"y":1667.5556640625,"wires":[[]]},{"id":"a3cce9c4ad84c072","type":"function","z":"4ce6f98c.254bf","name":"f","func":"var current = new Date().toLocaleString(\"en-GB\");\nvar alert=\"Door opened for a long time!\"\nvar sql= \"INSERT INTO HDB69390.Dataset (Time,Type,Info) VALUES ('\"+current+\"','Door','\"+alert+\"');\"\nmsg.payload = sql;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1010.0000152587891,"y":720,"wires":[["e7fe52d1e23a7a5e"]]},{"id":"e7fe52d1e23a7a5e","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"","params":"","name":"db","x":1214.0001220703125,"y":719.5556640625,"wires":[[]]},{"id":"342b03834f55b9db","type":"function","z":"4ce6f98c.254bf","name":"f","func":"var current = new Date().toLocaleString(\"en-GB\");\nvar alert = \"Temperature too high! \"\nvar sql= \"INSERT INTO HDB69390.Dataset (Time,Type,Info) VALUES ('\"+current+\"','Temperature','\"+alert+\"');\"\nmsg.payload = sql;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1059.0000610351562,"y":142.00000381469727,"wires":[["fb82429003ff0cd6"]]},{"id":"0c8a610d9a5258d0","type":"function","z":"4ce6f98c.254bf","name":"f","func":"\nvar current = new Date().toLocaleString(\"en-GB\");\nvar alert = \"Alert : SOS!\"\nvar sql= \"INSERT INTO HDB69390.Dataset (Time,Type,Info) VALUES ('\"+current+\"','Emergency','\"+alert+\"');\"\nmsg.payload = sql;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":941,"y":288,"wires":[["739955a2f8094371"]]},{"id":"193d30bbdf33f81a","type":"inject","z":"4ce6f98c.254bf","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 00 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":263,"y":1783,"wires":[["53d6b3c525aa9fff"]]},{"id":"cd70c20bef03859b","type":"function","z":"4ce6f98c.254bf","name":"","func":"var a=flow.get('counter3');\nflow.set('counter3',a+1);\nmsg.payload=a;  \nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":496.50000381469727,"y":1602.0000114440918,"wires":[["dc152cd4bd51e21e","2828884e7649ac49"]]},{"id":"53d6b3c525aa9fff","type":"function","z":"4ce6f98c.254bf","name":"reset","func":"flow.set('counter3',0)","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":1787,"wires":[[]]},{"id":"dc152cd4bd51e21e","type":"switch","z":"4ce6f98c.254bf","name":"","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"touchThreshold","vt":"global"}],"checkall":"true","repair":false,"outputs":1,"x":664,"y":1604,"wires":[["edc33c15f58b7b5d","b76389775e5a43ec"]]},{"id":"70f2bb4d6654fe03","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"Delete from HDB69390.Dataset","params":"","name":"db","x":1075.999942779541,"y":1813.0000953674316,"wires":[[]]},{"id":"135ac5d12bc59543","type":"inject","z":"4ce6f98c.254bf","name":"Clean the database every week ","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 22 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":826.4999694824219,"y":1813.0000190734863,"wires":[["70f2bb4d6654fe03"]]},{"id":"2828884e7649ac49","type":"ui_text","z":"4ce6f98c.254bf","group":"e77a4192185faba3","order":2,"width":0,"height":0,"name":"","label":"","format":"The medicine bottle has been touched {{payload}} times today.","layout":"row-spread","className":"","x":664.9999961853027,"y":1706.0000133514404,"wires":[]},{"id":"fffb6f11a3563490","type":"switch","z":"4ce6f98c.254bf","name":"","property":"payload.d.Touched","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":311,"y":1612.0000114440918,"wires":[["cd70c20bef03859b"]]},{"id":"77fb2bef6df6eca3","type":"ui_text","z":"4ce6f98c.254bf","group":"165ea06f704627e9","order":2,"width":0,"height":0,"name":"","label":"","format":"Door state: {{payload}}","layout":"row-left","className":"","x":710,"y":1104,"wires":[]},{"id":"6ce8d69895705a73","type":"function","z":"4ce6f98c.254bf","name":"","func":"var a= msg.payload;\nif(a==0){\n    msg.payload=\"open\"\n}\nelse{\n    msg.payload=\"close\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":497.5,"y":1098,"wires":[["77fb2bef6df6eca3"]]},{"id":"cdeaa2f229f500be","type":"ui_text","z":"4ce6f98c.254bf","group":"165ea06f704627e9","order":3,"width":0,"height":0,"name":"","label":"","format":"The door has opened for: {{msg.payload}}","layout":"row-left","className":"","x":1022,"y":880,"wires":[]},{"id":"a25999cc25d3ba37","type":"ui_text","z":"4ce6f98c.254bf","group":"1bb2d88d.8be177","order":3,"width":0,"height":0,"name":"","label":"","format":"The light is on for: {{payload}}","layout":"row-left","className":"","x":1334.0001029968262,"y":1350.0000081062317,"wires":[]},{"id":"65049f732538585a","type":"ui_text","z":"4ce6f98c.254bf","group":"165ea06f704627e9","order":4,"width":0,"height":0,"name":"","label":"Door Threshold","format":"{{msg.payload}} seconds","layout":"row-spread","className":"","x":1599,"y":845,"wires":[]},{"id":"58499e028077b1ee","type":"ui_slider","z":"4ce6f98c.254bf","name":"Door Threshold ","label":"slider","tooltip":"","group":"165ea06f704627e9","order":5,"width":0,"height":0,"passthru":true,"outs":"all","topic":"topic","topicType":"msg","min":"10","max":"100","step":1,"className":"","x":1343,"y":891,"wires":[["65049f732538585a","7c927b13faf68ada"]]},{"id":"7c927b13faf68ada","type":"function","z":"4ce6f98c.254bf","name":"set thresholf of door","func":"var thr = msg.payload;\nflow.set('DoorThreshold',thr);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1622.3333053588867,"y":915.9998731613159,"wires":[[]]},{"id":"f3951964cf018a69","type":"ui_text_input","z":"4ce6f98c.254bf","name":"","label":"Set Touch Threthold","tooltip":"","group":"e77a4192185faba3","order":5,"width":0,"height":0,"passthru":true,"mode":"number","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":105,"y":1684.8568439483643,"wires":[["e742e53be0b45af4","36625895631650fd"]]},{"id":"e742e53be0b45af4","type":"change","z":"4ce6f98c.254bf","name":"","rules":[{"t":"set","p":"touchThreshold","pt":"global","to":"payload","tot":"msg","dc":true}],"action":"","property":"","from":"","to":"","reg":false,"x":363.34643936157227,"y":1686.010367155075,"wires":[[]]},{"id":"36625895631650fd","type":"ui_text","z":"4ce6f98c.254bf","group":"e77a4192185faba3","order":6,"width":0,"height":0,"name":"","label":"","format":"Current threshold: {{payload}} times","layout":"row-left","className":"","x":296.8463726043701,"y":1726.010513305664,"wires":[]},{"id":"eb3c1577a3e39821","type":"ibmiot out","z":"4ce6f98c.254bf","authentication":"apiKey","apiKey":"a250f6a0ce2acc43","outputType":"cmd","deviceId":"9C9C1FC16194","deviceType":"mkr1010","eventCommandType":"display","format":"json","data":"msg.payload","qos":0,"name":"IBM IoT","service":"registered","x":1343.3464050292969,"y":1168.0104246139526,"wires":[]},{"id":"094591b2b42c6337","type":"function","z":"4ce6f98c.254bf","name":"f","func":"var t = msg.payload.delay;\nif(t<1){\n    msg.payload = \"Invalid delay\"    \n}else{\n    msg.payload = t;\n}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":979.4444580078125,"y":2574.888916015625,"wires":[["34df04274d85dacd","4038710b217c757d"]]},{"id":"34df04274d85dacd","type":"ui_text","z":"4ce6f98c.254bf","group":"2e7403489e979f39","order":1,"width":0,"height":0,"name":"","label":"Current delay: ","format":"{{msg.payload}} seconds","layout":"row-spread","className":"","x":1157.4444580078125,"y":2520.8889150619507,"wires":[]},{"id":"4038710b217c757d","type":"function","z":"4ce6f98c.254bf","name":"f","func":"var a =  msg.payload;\nif(a!=\"Invalid delay\" ){\n    msg.payload = a;\n    return msg;\n}else{\n    return null;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1129.444465637207,"y":2574.222268104553,"wires":[["329f29655acba251"]]},{"id":"329f29655acba251","type":"ibmiot out","z":"4ce6f98c.254bf","authentication":"apiKey","apiKey":"a250f6a0ce2acc43","outputType":"cmd","deviceId":"9C9C1FC16194","deviceType":"mkr1010","eventCommandType":"delay","format":"json","data":"msg.payload","qos":0,"name":"IBM IoT","service":"registered","x":1314.444465637207,"y":2574.8889350891113,"wires":[]},{"id":"dd5b32b859ba1615","type":"ui_form","z":"4ce6f98c.254bf","name":"Dashboard Sign-In","label":"","group":"d578224e28444246","order":1,"width":0,"height":0,"options":[{"label":"username","value":"username","type":"text","required":true,"rows":null},{"label":"password","value":"password","type":"password","required":true,"rows":null}],"formValue":{"username":"","password":""},"payload":"","submit":"Login","cancel":"Cancel","topic":"","topicType":"str","splitLayout":false,"className":"","x":117,"y":3217.333303451538,"wires":[["2dec186f9a96468e","8a3a5a315603b597","cf1cb3d22ccd2070"]]},{"id":"33533c283a550722","type":"debug","z":"4ce6f98c.254bf","name":"Debug Account Log ","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":635.0001411437988,"y":3178.3332748413086,"wires":[]},{"id":"584abad50fe0a691","type":"comment","z":"4ce6f98c.254bf","name":"Sign-In Section","info":"","x":162.00000762939453,"y":3158.3332481384277,"wires":[]},{"id":"2dec186f9a96468e","type":"function","z":"4ce6f98c.254bf","name":"Account Log","func":"var accountlog =  flow.get(\"accountlog\") || [] ; \n\naccountlog.push({ accessAt : new Date(), username : msg.payload.username})\n\nflow.set(\"accountlog\", accountlog);\n\nmsg.payload = accountlog;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":373.00000381469727,"y":3176.333275794983,"wires":[["33533c283a550722"]]},{"id":"8a3a5a315603b597","type":"function","z":"4ce6f98c.254bf","name":"Account Verification","func":"var accounts =  flow.get(\"accounts\") || [ { username : \"admin\", password : \"admin\"},{ username : \"guest\", password : \"guest\"}] ; \n\nvar username = msg.payload.username ;\nvar password = msg.payload.password ; \n\nmsg.payload = 1;\n\naccounts.forEach(function ( account ){\n    if ( account.username == username ) {\n       msg.payload = 2;\n       if ( account.password == password ) {\n           msg.payload = 0;\n       } \n    }\n});\n\nif ( msg.payload == 0 ) {\n  var currentsocketid = flow.get(\"clientid\") || undefined;\n  if ( currentsocketid !== undefined && currentsocketid !== msg.socketid ) msg.payload = 3;\n}\n// keep the original socketid from msg.socketid;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":379.000057220459,"y":3240.333275794983,"wires":[["acfb2eee2d531b9c"]]},{"id":"acfb2eee2d531b9c","type":"switch","z":"4ce6f98c.254bf","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"str"},{"t":"eq","v":"2","vt":"str"},{"t":"eq","v":"3","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":543.0000419616699,"y":3261.333240509033,"wires":[["d25bd28591e65521"],["88d0890059131354"],["9b7d48dd2418eefa"],["b0e89ca576d27da4"]]},{"id":"d25bd28591e65521","type":"function","z":"4ce6f98c.254bf","name":"= 0 : Success","func":"/* activate session timer */\nvar sessionTimer =  flow.get(\"sessionTimer\") || 0; \nvar currTime = Date.now();\nflow.set(\"sessionTimer\", currTime);\nflow.set(\"clientid\", msg.socketid);\n/* ui-control payload */\nmsg.payload = { group: {\n    show : [\"Edge_Touch\", \n    \"Edge_Light\",\n    \"Edge_Door\",\n    \"Edge_Temp\",\n    \"Edge_Arduino_Controls\",\n    \"Edge_Alert_History\",\n    \"Edge_Button\",\n    \"Edge_Dashboard_Controls\"],\n    hide : [\"Edge_Signin\"]\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":712.999885559082,"y":3217.3332500457764,"wires":[["c7274c9f3d8e7794"]]},{"id":"88d0890059131354","type":"function","z":"4ce6f98c.254bf","name":"= 1 : Unknown User","func":"msg.payload = \"Username Doesn't exist!!!\"\nreturn msg;","outputs":1,"noerr":0,"x":733.9998931884766,"y":3254.333251953125,"wires":[["185f439a5a1316c7"]]},{"id":"9b7d48dd2418eefa","type":"function","z":"4ce6f98c.254bf","name":"= 2 : Wrong Password","func":"msg.payload = \"Invalid Password\";\nreturn msg;","outputs":1,"noerr":0,"x":734.9999618530273,"y":3291.333264350891,"wires":[["185f439a5a1316c7"]]},{"id":"c7274c9f3d8e7794","type":"ui_ui_control","z":"4ce6f98c.254bf","name":"Go to Sensor/History Group","x":997.0001068115234,"y":3214.3333320617676,"wires":[[]]},{"id":"185f439a5a1316c7","type":"ui_toast","z":"4ce6f98c.254bf","position":"dialog","displayTime":"3","highlight":"","sendall":true,"outputs":1,"ok":"OK","cancel":"","raw":false,"className":"","topic":"Authentication Failed","name":"Authentication Failure Dialog","x":999.9999732971191,"y":3274.333251953125,"wires":[[]]},{"id":"2bed1f17a1ef6460","type":"comment","z":"4ce6f98c.254bf","name":"Session Management - 15 secs for this demo","info":"","x":241.5,"y":3374.3332595825195,"wires":[]},{"id":"dc29486e2acd2fc4","type":"inject","z":"4ce6f98c.254bf","name":"Timer","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150.00000762939453,"y":3463.3332443237305,"wires":[["891f1180ea9171e1","8fd8a64b804e8278"]]},{"id":"891f1180ea9171e1","type":"function","z":"4ce6f98c.254bf","name":"Detect Session Timer","func":"var sessionTimer =  flow.get(\"sessionTimer\") || 0; \nvar currTime = Date.now();\nvar SESSION_TIMEOUT = 5000000; //15 secs\n\nif ( sessionTimer === 0 /* Inactive, No user signed in */ ) {\n    msg.payload = 2;\n} else {\n    if ( currTime - sessionTimer > SESSION_TIMEOUT ) {\n      msg.payload = 0;  \n    } else {\n      msg.payload = 1;        \n    }\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":338.00003814697266,"y":3429.3332595825195,"wires":[["542eee4338595863"]]},{"id":"542eee4338595863","type":"switch","z":"4ce6f98c.254bf","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"str"},{"t":"eq","v":"2","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":508.00007247924805,"y":3427.3332595825195,"wires":[["009e4d1c7b49fef1"],["025318cc11c7dad0"],["c8dc69d59e90b699"]]},{"id":"009e4d1c7b49fef1","type":"function","z":"4ce6f98c.254bf","name":"Time-Out","func":"/* activate session timer */\nvar sessionTimer =  flow.get(\"sessionTimer\") || 0; \nflow.set(\"sessionTimer\", 0);\n\nmsg.socketid = flow.get(\"clientid\") || undefined;\nmsg.payload = \"Session Expired! Please singin again!\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":663.9999847412109,"y":3400.333263397217,"wires":[["6b938fa6028e1c38","6a06a4c7c1bf1088"]]},{"id":"6b938fa6028e1c38","type":"ui_toast","z":"4ce6f98c.254bf","position":"dialog","displayTime":"3","highlight":"","sendall":true,"outputs":1,"ok":"OK","cancel":"","raw":false,"className":"","topic":"Session Timeout","name":"Time-Out Dialog","x":851.500114440918,"y":3366.333263397217,"wires":[[]]},{"id":"0a2e87de7240a1dc","type":"ui_ui_control","z":"4ce6f98c.254bf","name":"Go to Signin Group","x":1058.5000324249268,"y":3402.3332481384277,"wires":[[]]},{"id":"6a06a4c7c1bf1088","type":"function","z":"4ce6f98c.254bf","name":"Sign-In Redirection","func":"var msg = {};\n\nmsg.socketid = flow.get(\"clientid\") || undefined;\nmsg.payload = { group: {\n  hide : [\"Edge_Touch\", \n    \"Edge_Light\",\n    \"Edge_Door\",\n    \"Edge_Temp\",\n    \"Edge_Arduino_Controls\",\n    \"Edge_Alert_History\",\n    \"Edge_Button\",\n    \"Edge_Dashboard_Controls\"],\n   show : [\"Edge_Signin\"]\n}\n};\n\nflow.set(\"clientid\", undefined);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":862.0000228881836,"y":3403.3332595825195,"wires":[["0a2e87de7240a1dc"]]},{"id":"8fd8a64b804e8278","type":"function","z":"4ce6f98c.254bf","name":"Calculating Remaining Time (Debug)","func":"var sessionTimer =  flow.get(\"sessionTimer\") || 0; \nvar currTime = Date.now();\nvar remainingSecs = Math.floor((5000000 - (currTime - sessionTimer))/1000) + 1;\n    \nif ( sessionTimer == 0 /* Inactive, No user signed in */ ) {\n    return null;\n} else {\n    \n    if ( remainingSecs <= 7 ) msg.payload = \"Remaining : \" + remainingSecs + \" secs\";  \n    else return null;\n}\n\nmsg.socketid = flow.get(\"clientid\") || \"B1234\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":388.0000305175781,"y":3517.3332719802856,"wires":[[]]},{"id":"c8f04c5865e072e9","type":"ui_ui_control","z":"4ce6f98c.254bf","name":"Stay in Sensor Group","x":1008.5000991821289,"y":3441.333257675171,"wires":[[]]},{"id":"025318cc11c7dad0","type":"function","z":"4ce6f98c.254bf","name":"Sensor/History Goup","func":"var msg = {};\nmsg.socketid = flow.get(\"clientid\") || undefined;\nmsg.payload = { group: {\n   show : [\"Edge_Touch\", \n    \"Edge_Light\",\n    \"Edge_Door\",\n    \"Edge_Temp\",\n    \"Edge_Arduino_Controls\",\n    \"Edge_Alert_History\",\n    \"Edge_Button\",\n    \"Edge_Dashboard_Controls\"],\n    hide : [\"Edge_Signin\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":705.5000305175781,"y":3441.3332557678223,"wires":[["c8f04c5865e072e9"]]},{"id":"c8dc69d59e90b699","type":"function","z":"4ce6f98c.254bf","name":"Signin Goup","func":"var msg = {};\nmsg.payload = { group: {\n  hide : [\"Edge_Touch\", \n    \"Edge_Light\",\n    \"Edge_Door\",\n    \"Edge_Temp\",\n    \"Edge_Arduino_Controls\",\n    \"Edge_Alert_History\",\n    \"Edge_Button\",\n    \"Edge_Dashboard_Controls\"],\n    show : [\"Edge_Signin\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":690.500114440918,"y":3481.3334407806396,"wires":[["5d7f8d81d3d048b8"]]},{"id":"5d7f8d81d3d048b8","type":"ui_ui_control","z":"4ce6f98c.254bf","name":"Go to Signin Group","x":996.5002479553223,"y":3479.333293914795,"wires":[[]]},{"id":"cf1cb3d22ccd2070","type":"debug","z":"4ce6f98c.254bf","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":364.5000305175781,"y":3314.8678092956543,"wires":[]},{"id":"8dd926130a4732b6","type":"ui_toast","z":"4ce6f98c.254bf","position":"dialog","displayTime":"3","highlight":"","outputs":1,"ok":"OK","cancel":"","topic":"System In Use.","name":"System In-Use Dialog","x":983.1111793518066,"y":3327.4547872543335,"wires":[[]]},{"id":"b0e89ca576d27da4","type":"function","z":"4ce6f98c.254bf","name":"= 4 : System In Use","func":"msg.payload = \"System is used by other user.\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":720.4443340301514,"y":3334.4551849365234,"wires":[["8dd926130a4732b6"]]},{"id":"d6c917e051e2056f","type":"function","z":"4ce6f98c.254bf","name":"","func":"var a = msg.payload.d.Motion;\nif(a==1){\n    msg.payload=\"Some one in the room\";\n}\nelse{\n    msg.payload = \"No one in the room\";\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340.4444465637207,"y":1470.6666374206543,"wires":[["63ebef5c02ba08a0"]]},{"id":"63ebef5c02ba08a0","type":"ui_text","z":"4ce6f98c.254bf","group":"1bb2d88d.8be177","order":4,"width":0,"height":0,"name":"","label":"","format":"{{payload}}","layout":"row-left","className":"","x":542.5555610656738,"y":1467.6666374206543,"wires":[]},{"id":"7db57965.76d468","type":"ui_button","z":"4ce6f98c.254bf","name":"","group":"0a8366eac8ed8936","order":3,"width":"2","height":"1","passthru":false,"label":"Go to database","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"Node-RED","payloadType":"str","topic":"","topicType":"str","x":311.44444274902344,"y":2711.6666316986084,"wires":[["ece06122.7e762"]]},{"id":"5e1f0081.6dc3c","type":"ui_template","z":"4ce6f98c.254bf","group":"0a8366eac8ed8936","name":"window redirect","order":4,"width":0,"height":0,"format":"<script>\n(function(scope) {\n    scope.$watch('msg.payload', function(data) {\n        if (data == \"Node-RED\") {\n          //window.open(\"https://www.nodered.org\");\n          window.location.href = \"https://bs2ipcul0apon0jufi80lite.db2.cloud.ibm.com/crn%3Av1%3Abluemix%3Apublic%3Adashdb-for-transactions%3Aeu-gb%3Aa%2F7411656e135c48c49ee301f20db904b0%3A135b1878-f531-410a-807d-6c5bfaf925eb%3A%3A/console/index.html#explore/table\";\n        } \n\n    });\n})(scope);\n</script>","storeOutMessages":false,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","className":"","x":681.444450378418,"y":2710.66676902771,"wires":[["8582289.2d757d8"]]},{"id":"ece06122.7e762","type":"trigger","z":"4ce6f98c.254bf","name":"reset msg","op1":"","op2":"empty","op1type":"pay","op2type":"str","duration":"250","extend":false,"overrideDelay":false,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":503.4444580078125,"y":2709.666748046875,"wires":[["5e1f0081.6dc3c"]]},{"id":"8582289.2d757d8","type":"debug","z":"4ce6f98c.254bf","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":873.4444580078125,"y":2709.666748046875,"wires":[]},{"id":"24aa8a0394a8a92b","type":"ibmiot out","z":"4ce6f98c.254bf","authentication":"apiKey","apiKey":"a250f6a0ce2acc43","outputType":"cmd","deviceId":"9C9C1FC16194","deviceType":"mkr1010","eventCommandType":"display","format":"json","data":"msg.payload","qos":0,"name":"IBM IoT","service":"registered","x":649.8464050292969,"y":2098.010229110718,"wires":[]},{"id":"88537999220e8499","type":"function","z":"4ce6f98c.254bf","name":"tosql","func":"var current = new Date().toLocaleString(\"en-GB\");\nvar sql= \"INSERT INTO HDB69390.Dataset (Time,Door) VALUES ('\"+current+\"','\"+msg.payload+\"');\"\nmsg.payload = sql;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":573.0129928588867,"y":1024.010419845581,"wires":[["2e8cdc74190e6ca4"]]},{"id":"2e8cdc74190e6ca4","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"","params":"","name":"db","x":752.4192409515381,"y":1025.302017211914,"wires":[[]]},{"id":"4066bfd922980c25","type":"function","z":"4ce6f98c.254bf","name":"tosql","func":"var current = new Date().toLocaleString(\"en-GB\");\nvar sql= \"INSERT INTO HDB69390.Dataset (Time,Touch) VALUES ('\"+current+\"','\"+msg.payload+\"');\"\nmsg.payload = sql;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":474.0129795074463,"y":1566.0103931427002,"wires":[["efb4a553d72f757f"]]},{"id":"efb4a553d72f757f","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"","params":"","name":"db","x":653.4192276000977,"y":1567.3019905090332,"wires":[[]]},{"id":"969537d294cfb22f","type":"function","z":"4ce6f98c.254bf","name":"tosql","func":"var current = new Date().toLocaleString(\"en-GB\");\nvar sql= \"INSERT INTO HDB69390.Dataset (Time,Temp) VALUES ('\"+current+\"','\"+msg.payload+\"');\"\nmsg.payload = sql;\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":798.0128517150879,"y":52.01042079925537,"wires":[["7e35b1e7237b4382"]]},{"id":"327c5832d1e2a522","type":"inject","z":"4ce6f98c.254bf","name":"Clean the database every day","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"00 00 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":840.1796875,"y":1882.0103759765625,"wires":[["ad5cc0f599eb9bed"]]},{"id":"ad5cc0f599eb9bed","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"SELECT COUNT(*) FROM HDB69390.Dataset","params":"","name":"get db count","x":1157.8462600708008,"y":1881.0104684829712,"wires":[["741fce0f99a0dcff"]]},{"id":"741fce0f99a0dcff","type":"switch","z":"4ce6f98c.254bf","name":"","property":"payload.d.Touched","propertyType":"msg","rules":[{"t":"gt","v":"10000","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":1324.8462677001953,"y":1881.010469675064,"wires":[["b1e6029925f1b7a3"]]},{"id":"b1e6029925f1b7a3","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"delete from HDB69390.Dataset order by TIME ASC fetch first 1000 rows only","params":"","name":"delete the earliest 500 data","x":1566.0129623413086,"y":1868.0105514526367,"wires":[[]]},{"id":"5c3c891882f6d6b2","type":"debug","z":"4ce6f98c.254bf","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1152.333381652832,"y":1050.0000076293945,"wires":[]},{"id":"4aeaf6802904f10c","type":"gate","z":"4ce6f98c.254bf","name":"","controlTopic":"control","defaultState":"open","openCmd":"open","closeCmd":"close","toggleCmd":"toggle","defaultCmd":"default","statusCmd":"status","persist":false,"storeName":"memory","x":1632.333381652832,"y":1110.0000076293945,"wires":[[]]},{"id":"91bd566fd34e475e","type":"function","z":"4ce6f98c.254bf","name":"Cloudiness","func":"if(msg.payload.hourly[0].clouds<70){\n    msg.payload='open';\n    msg.topic='control';\n}else{\n    msg.payload='close';\n    msg.topic='control';\n}\nreturn msg","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1412.333381652832,"y":1110.0000076293945,"wires":[["4aeaf6802904f10c","fd8e4a0226228a95"]]},{"id":"fd8e4a0226228a95","type":"debug","z":"4ce6f98c.254bf","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1412.333381652832,"y":1050.0000076293945,"wires":[]},{"id":"977e06b9ad3a85b0","type":"openweathermap","z":"4ce6f98c.254bf","name":"Weather of London ","wtype":"onecall","lon":"-0.118","lat":"51.509","city":"","country":"","language":"en","x":1172.333381652832,"y":1110.0000076293945,"wires":[["91bd566fd34e475e","5c3c891882f6d6b2"]]},{"id":"f13a83a5bc0692d2","type":"inject","z":"4ce6f98c.254bf","name":"Get Weather","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3600","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":942.333381652832,"y":1070.0000076293945,"wires":[["977e06b9ad3a85b0"]]},{"id":"739955a2f8094371","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"","params":"","name":"db","x":1140.5131702423096,"y":300.01038551330566,"wires":[[]]},{"id":"fb82429003ff0cd6","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"","params":"","name":"db","x":1232.5130615234375,"y":131.0104217529297,"wires":[[]]},{"id":"7e35b1e7237b4382","type":"Db2 in","z":"4ce6f98c.254bf","Db2":"ae43218bc16e9689","service":"_ext_","query":"","params":"","name":"db","x":986.5130004882812,"y":47.01041793823242,"wires":[[]]},{"id":"4a78c4462798f8f7","type":"ui_gauge","z":"4ce6f98c.254bf","name":"","group":"aa9faad8aa46c5e9","order":1,"width":0,"height":0,"gtype":"gage","title":"The sum of count per week ","label":"units","format":"{{value}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","className":"","x":835.5,"y":586,"wires":[]},{"id":"03c937715c0a21ec","type":"ui_slider","z":"4ce6f98c.254bf","name":"","label":"slider","tooltip":"","group":"aa9faad8aa46c5e9","order":1,"width":0,"height":0,"passthru":true,"outs":"all","topic":"topic","topicType":"msg","min":0,"max":10,"step":1,"className":"","x":776.5,"y":638,"wires":[["cf127b264605feb7","d7f226a466ae1aa1"]]},{"id":"cf127b264605feb7","type":"ui_text","z":"4ce6f98c.254bf","group":"aa9faad8aa46c5e9","order":2,"width":0,"height":0,"name":"","label":"threshold","format":"{{msg.payload}}","layout":"row-spread","className":"","x":912.5,"y":664,"wires":[]},{"id":"f32f2639dc4165cd","type":"inject","z":"4ce6f98c.254bf","name":"Instructions","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"23","payloadType":"str","x":729,"y":505,"wires":[["4a78c4462798f8f7"]]},{"id":"d7f226a466ae1aa1","type":"template","z":"4ce6f98c.254bf","name":"Alert Msgtendency for deterioration","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Alert : The memory of the patient has a deterioration trend.","output":"str","x":1191,"y":625,"wires":[["d39c7273f7ef0e53"]]},{"id":"d39c7273f7ef0e53","type":"ui_toast","z":"4ce6f98c.254bf","position":"top right","displayTime":"5","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"className":"","topic":"","name":"","x":1310,"y":622,"wires":[]},{"id":"a250f6a0ce2acc43","type":"ibmiot","name":"tws4j2","keepalive":"60","serverName":"tws4j2.messaging.internetofthings.ibmcloud.com","cleansession":true,"appId":"","shared":false},{"id":"1bb2d88d.8be177","type":"ui_group","name":"Sensors","tab":"88fe602a.e1955","order":1,"disp":true,"width":"6","collapse":false,"className":""},{"id":"e77a4192185faba3","type":"ui_group","name":"Touch","tab":"7c4850f390160218","order":2,"disp":true,"width":"6","collapse":false,"className":""},{"id":"165ea06f704627e9","type":"ui_group","name":"Door","tab":"7c4850f390160218","order":4,"disp":true,"width":"6","collapse":false,"className":""},{"id":"5459e4d16930a8b0","type":"ui_group","name":"Temp","tab":"7c4850f390160218","order":5,"disp":true,"width":"6","collapse":false,"className":""},{"id":"e45f276432ecdd8d","type":"ibmiot","name":"Instructor IOTF API details","keepalive":"60","serverName":"07j0fn.messaging.internetofthings.ibmcloud.com","cleansession":true,"appId":"","shared":false},{"id":"0a8366eac8ed8936","type":"ui_group","name":"Dashboard Controls","tab":"7c4850f390160218","order":7,"disp":true,"width":"6","collapse":false,"className":""},{"id":"ae43218bc16e9689","type":"Db2","hostname":"815fa4db-dc03-4c70-869a-a9cc13f33084.bs2io90l08kqb1od8lcg.databases.appdomain.cloud","db":"bludb","port":"30367","name":""},{"id":"2e7403489e979f39","type":"ui_group","name":"Arduino Controls","tab":"7c4850f390160218","order":6,"disp":true,"width":"6","collapse":false,"className":""},{"id":"8d9c5eafccaf7b45","type":"ui_group","name":"Alert History","tab":"7c4850f390160218","order":8,"disp":true,"width":"12","collapse":false,"className":""},{"id":"d578224e28444246","type":"ui_group","name":"Signin","tab":"7c4850f390160218","order":1,"disp":true,"width":"6","collapse":false,"className":""},{"id":"aa9faad8aa46c5e9","type":"ui_group","name":"Countings","tab":"7c4850f390160218","order":9,"disp":true,"width":"6","collapse":false,"className":""},{"id":"88fe602a.e1955","type":"ui_tab","name":"Edge system","icon":"dashboard","order":3,"disabled":false,"hidden":false},{"id":"7c4850f390160218","type":"ui_tab","name":"Edge","icon":"dashboard","order":1,"disabled":false,"hidden":false}]